<html>
<head>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <title>Конные колесницы</title>
</head>
<body>
<div class="container">
  <h1>Магазин колесниц</h1>
  <ul class="list-group">
    <chariot v-for="(chariot, index) in chariots" :key="index" :chariot="chariot" :current="current"
             @select="updateChariot">
    </chariot>
  </ul>
  <pre>{{ $data }}</pre>
</div>
<!-- шаблон компонента -->
<template id="chariot-template">
  <li class="list-group-item">
    <h4>У колесницы "{{ chariot.name }}" <strong>{{ chariot.horses }}</strong> лошадей!</h4>
    <button @click="rideChariot(chariot)" class="btn btn-primary" :disabled="isCurrent">
      {{ action }}
    </button>
  </li>
</template>
<!-- конец шаблона компонента -->
</body>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.js"></script>
<script type="text/javascript">
  Vue.component('chariot', {
    props: ['chariot', 'current'],
    template: '#chariot-template',
    methods: {
      rideChariot: function (chariot) {
        this.$emit('select', chariot)
      },
    },
    computed: {
      // будет true, когда колесница имеет больше лошадей, чем текущая
      hasMoreHorses: function () {
        return this.current.horses < this.chariot.horses
      },
      // будет true, когда колесница является текущей
      isCurrent: function () {
        return this.current.name === this.chariot.name
      },
      // будет true, когда нет текущей колесницы
      noChariot: function () {
        return this.current.name === null;
      },
      // определить действие для каждой колесницы
      action: function () {
        var action;
        if (this.noChariot) {
          action = 'Выбрать колесницу'
        } else if (this.isCurrent) {
          action = 'В путь!'
        } else if (this.hasMoreHorses) {
          action = 'Нанять лошадей'
        } else {
          action = 'Отклонить лошадей'
        }
        return action;
      }
    }
  });
  var vm = new Vue({
    el: '.container',
    data: {
      chariots: [
        {name: "Олимп", horses: 4},
        {name: "Саггита", horses: 3},
        {name: "Икар", horses: 2},
        {name: "Абраксас", horses: 1},
      ],
      // текущая 'колесница'
      current: {}
    },
    methods: {
      updateChariot: function (chariot) {
        this.current = chariot
      }
    }
  })
</script>
</html>
